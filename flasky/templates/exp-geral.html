{% extends 'base.html' %}

{% block content %}

<div class="alert alert-primary" role="alert">
  <i class="bi-info-circle"></i>
  Experiência de hoje será contabilizada às 00:30h.
</div>

<a href="{{ url_for('home.download_old_exp') }}">Download files exp overall</a>

<table class="table table-hover caption-top"
       data-toggle="table"
       data-show-columns="true"
       data-custom-sort="customSort"
       data-search="true"
       data-show-columns-toggle-all="true"
       >
  <caption>Experiência do mês atual</caption>
  <thead>
    <tr>
      <th data-sortable="false" data-field="player">Player</th>
      <th data-sortable="true" data-field="exp">EXP</th>
      <th data-sortable="true" data-field="lvin">Lv. In</th>
      <th data-sortable="true" data-field="lvout">Lv. Out</th>
      <th data-sortable="true" data-field="diff">Diff</th>
    </tr>
  </thead>

  <tbody>
    {% for player in data %}
    <tr>
      <td><img src="{{ player[0] }}" style="width: 30px;"><a href="{{ url_for("user.character", character=player[1]) }}">{{ player[1] }}</a><a href="https://san.taleon.online/characterprofile.php?name={{ player[1] }}" style="margin-left:10px"></a></td> 
      <td>{{ player[2] }}</td>
      <td>{{ player[3] }}</td>
      <td>{{ player[4] }}</td>
      <td>{{ player[5] }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<script>
  function customSort(sortName, sortOrder, data) {
    var order = sortOrder === 'desc' ? -1 : 1
    data.sort(function (a, b) {
      var aa = +((a[sortName] + '').replace(/[^-\d]/g, ''))
      var bb = +((b[sortName] + '').replace(/[^-\d]/g, ''))
      if (aa < bb) {
        return order * -1
      }
      if (aa > bb) {
        return order
      }
      return 0
    })
  }
</script>

{% endblock %}
